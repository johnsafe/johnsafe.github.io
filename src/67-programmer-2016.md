## 制作 3A 级 VR 游戏的难点——专访焰火工坊 CTO 王明杨



记者/唐小引

王明杨，现任焰火工坊 CTO，最早在网龙负责91手机助手团队，后自主创业，研发了“LBE 安全大师”安全软件。接着开始做手游，并与暴风合作，开发了魔镜第一代 App。2014年11月，与两位伙伴一起创立了现在的焰火工坊，目前正在着手 VR 眼镜、SDK 以及 VR 影院的研发迭代中。

### 由软及硬，服务于移动 VR 开发者

王明杨与其团队对于 VR 的理解起始于软件，也一直专注于移动 VR 的软硬件研发工作。最早是从 VR 影院入手，随后一步一步做 VR 内容。而在此过程中，他发现现有的 Mobile VR 硬件都难于达到较好的效果，在对 Gear VR 以及其他移动 VR 设备进行了拆解分析后，总结出差异主要体现在三个方面：

1. Gear VR 是一个软件和硬件于一体的设计，在软件方面，手机内部为了 VR 做了很多优化；

2. Gear VR 有一部分算法是在手机内部而非外部硬件上；

3. Gear VR 使用了一些外部硬件，比如外置的感应器和触摸设备。这也是 Gear VR 能做到软件和外置的光学壳子完美统一的重要原因，且外置 IMU 也能带来很高的采用率和相对稳定的时延。其次，三星自身也使用了外置 IMU，证明 Android 系统本身在内置的硬件实时性上不是特别好。

由此，王明杨与团队产生了自己做一款硬件的想法，至少让其所研发的 SDK 能有一个好载体，也就是现在的 JiDome-1。“我们正在做这样一件事，一方面是在做 VR 软硬件技术和实现上的一些研发，另一方面就是自有的软硬件产品。基于 Dawn SDK 和 JiDome-1 开发版，我们能达到 Gear VR 百分之八九十的水准，但是成本很低，开发者只需要购买199块钱的眼镜盒子，然后下载我们的软件，就可以达到这样的体验。”

同时，焰火工坊还制作了一套 Unity 插件，开发者可以使用 Unity3D 基于其 SDK 来开发 VR 内容，而为此焰火工坊还专门研发了一套极幕 OS（如图1所示）。目前 Dawn SDK 的版本还仅支持 Unity 开发，对此王明杨表示，接下来会提供原生的插件和 Unreal 插件，让开发者可以基于现有的主流引擎来快速开发。

<img src="http://ipad-cms.csdn.net/cms/attachment/201605/57283af7cb386.png" alt="图1  正在研发中的极幕OS" title="图1  正在研发中的极幕OS" />

图1  正在研发中的极幕 OS

<img src="http://ipad-cms.csdn.net/cms/attachment/201605/57283b00e8f0c.png" alt="图2  极幕VR影院开发" title="图2  极幕VR影院开发" />

图2  极幕 VR 影院开发

不同于一般的 VR SDK，除了游戏和应用之外，焰火工坊的研发团队也一直在致力于 VR 影院的研发工作（如图2所示），而开发者也可以使用 Dawn SDK 来开发 VR 视频播放器。在采访中，王明杨还特别提到，“未来将完整地开源一个自有的播放器 Demo，从播放、控制到环境的渲染等，其次也包括 SDK，希望能够帮助一些对 VR 感兴趣，但不是特别专业，只会简单写 Unity 脚本的人，来快速开发 VR 程序，这会是后续迭代的事情。”笔者在亲身体验 VR 影院时，的确收获了不错的体验，只不过一个偌大的影院里，只有自己在观看视频，其实很缺乏社交属性。对于这点，王明杨表示，现在依然集中精力在完善功能体验，社交等属性后续将会考虑到。一门正在发展的技术从萌芽到成熟不可能一蹴而就，技术与 VR 热潮下的参与者们，都需要时间来成长，也需要时间来打磨产品。而在此之中，开源就是一个很好的方式，比如在一个月前，Cocos VR 就将其团队开发的一款 VR 游戏 Demo 代码托管到了 GitHub 上。

### 触知虚拟现实

王明杨对 VR 的认知开始于2010年，当时他的朋友在做类似于现在 Cardboard 或暴风魔镜的一款设备，用来观看 3D 电影，可以将手机放在眼前，通过透镜进行左右眼放大。王明杨和朋友进行了尝试，“那个时候手机都内置陀螺仪，用陀螺仪来做一些头部的位置追踪，感觉很好玩儿，但一直没有将它当成一项事业。”

后来，暴风科技 CEO 冯鑫在看到 Oculus，认为虚拟现实头显用手机也可以实现。擅长软件的王明杨在与冯鑫多次接触沟通后，就开始带领团队进行了第一代暴风魔镜 App 的开发。

浮躁的互联网圈子里，有这样两种产品理念，一是快速推向市场，后期不断更新迭代；二是打磨得自己满意才会正式公开。但国内的大环境决定了很少有公司能够像 Oculus 等那样，消费者零售版在经过多次完善后才于今年上市。言谈之间，王明杨的理念显然是后者。

不过，精细化打磨也直接造成了一个结果，就是 Dawn SDK 正式版跳票，而这很大程度上是因为硬件尚不完善。对此，王明杨是这样说的：“硬件不是我们所擅长的，遇到过很多的坑，比如电路设计、嵌入式程序开发、镜片、手板结构等都是问题。我们利用这段时间一直在做一些完善工作，以进一步优化。我们能保证的是，在正式开放给开发者的时候，会是一个比较完整的 SDK，也希望能够收获他们有价值反馈。”

### VR 知识点以及制作 3A 级 VR 游戏的难点

在采访过程中，笔者特地邀请王明杨思考，从开发者角度而言，他们需要掌握哪些知识点来入门或进阶 VR 开发，尤其是移动 VR 方面，具体如下：

VR 开发从技术上来说，分很多种。如果希望开发内容、做 VR 底层技术，或是更复杂的比如 3A 级游戏和应用，实际上是不太一样的。开发 VR 内容，首先需要明确什么样的内容适合 VR。如果你是一个经验丰富的 Cocos2D 开发者，可能上手会比较吃力，因为 VR 需要的知识大部分是 3D 方面。其次，开发者可能需要迎合 VR 的设计，比如在 2D 游戏或传统手游中常用的 GUI 系统，实际上需要在 VR 中给它一个真实的深度和表现，才不会影响视觉对焦。具备诸如此类的 VR 设计方面的知识，或怎样尽可能地减少眩晕，在移动上不要用特别快的速度，以及视频拍摄角度等可能都需要了解。

继而，开发者需要给自己寻找定位，确定自己究竟想要做什么类型的东西，以及该类型的 VR 表现如何。这时可能就需要做 Demo，或下载别人的 Demo 去尝试一下，看看什么样的内容在 VR 上是真正合适的。

然后，最重要的是自己想基于什么样的平台。如果是类似 Cardboard 或暴风魔镜，可能就不需要特别高的要求。只需尽量让场景简单，不要特别复杂。因为这样的设备时延很高，任何的剧烈运动或复杂场景都会造成眩晕。其他方面还包括是否符合趣味性，怎么把趣味性和 VR 融合到一起，这些应该算是产品和策划方面的内容。

最后，王明杨特别提到：“如果想做 3A 级的产品，可能需要了解更多，比如我们现在正在做的 ATW 算法，它的原理是怎样的。了解原理就可以理解在开发过程中，遇到的一些问题该如何优化。另外，可能还需要了解 OpenGL 的工作方式，比如很多 Unity 程序员都会谈到 Draw Call，但可能并不理解。Draw Call 有长短之分，绘制的东西越多，时延会越大，但 CPU 端是检验不出来的。所以，不管是手游、端游，都会采用合并 Draw Call 的优化方式，将很多东西打到一个 Draw Call 里，一起发送到 GPU 进行渲染，这是一个能有效地减少 Draw Call 的方法。但在 VR 中，如果一味地合并 Draw Call 可能会有些问题，导致移动时增加延迟。因此，如果想要开发 3A 级应用，可能更多地需要考虑如何做优化，怎样节省性能达到更好的效果。”

“而除了降低延迟外，在 UI 设计上也不能让 UI 阻挡视野。我比较建议尽量避免使用 GUI，GUI 是人为了跟平面交互的产物，而不是 VR，VR 更倾向于场景化和拟物化。”王明杨如是说道。

### 当前在 VR 开发方面有哪些误区？

尽管 VR 火热，但其技术并不成熟，而现在许多人对 VR 研发还是存在一定的误区，王明杨对此进行具体分享：“比如有一些公司会专注于将传统的 2D 游戏进行左右分屏，实际上并没有运用到 VR 的头部追踪，包括对摄像机的控制、真实的位置控制，以及不按真实制作的场景比例等，这都不是好设计。因为如果不用头部追踪，用户的视觉在被遮住时，实际上是没有反馈的，会感觉很晕；其次，用户看到东西的景深和真实的景深不一样，这会直接导致出现疲累的感觉。同时，单纯的左右分屏并不是 VR 的方向，VR 应该是真实的虚拟现实中的体验，用户应该能够完整地控制自己的视野，能在虚拟场景中随机观察，未来可能会实现随意移动，这些都是很有必要的。”

<img src="http://ipad-cms.csdn.net/cms/attachment/201605/57283b21a645c.jpg" alt="" title="" />