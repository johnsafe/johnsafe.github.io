## 2016年，我们为什么要学习 C++？

文/Krzysztof Szatan    译/孙薇

>学习 C++ 的一大好处在于，它可以帮助我们理解生命周期（Lifetime）和所有权（Ownership）的概念，以及类型的抽象，还可了解到怎样利用类型保持 API 的使用方式不变。除此之外，为何各种高级语言层出的今天，学习 C++ 仍颇有价值？本文将为你道来。

### “C++ 已死”

大学时代，我就听过这样的说法——差不多十年前的事儿了。那时候至少在美国，Java 已经成了各公司的主流语言。程序员也许都很熟悉 Joel Spolsky 在2005年12月对 JavaSchools 发起的批驳。此外，作为微软应对 Java 的手段，2000年左右推出的 C# 也有 C++ 杀手的称号。这之后，动态语言风靡一时，Ruby 和 Python 开始流行起来。那么，既然有了这些好用的语言，我们为什么还要选择 C++ 语言呢？它难道不是 C 语言进阶版吗，就像当初的汇编语言进阶版一样？如果有时间，建议大家听一下 Herb Sutter 的演讲（《C++ and Beyond 2011:Herb Sutter - Why C++?》），讲得很好；时间有限的话也可以只看另一个较短的视频演讲（《C++:Conformance And Cross-Platform Mobile Development》），其中包含有具体案例。从TIOBE语言排行榜中我们可以发现，在过去逾15年的时间里，C++ 一直稳居最受欢迎语言列表的第三名。对一个老牌语言来说，这个成绩不算差了。这让我想到了另一个问题……

### 大家怎么看待指针？

大多立即将 C++ 与指针关联起来的人都学错了。“带类的 C 语言”已经是老一套了。根据我个人经验，它糟糕透了。在 C 语言中，将多维数组作为函数参数传送、执行指针运算、以手动方式管理内存（就好像没有容器与智能指针一样）、实现双向链表等等，所有这些都是我们应当在 C 语言的课程上学过的。也许通过这种方式来学习 C++ 并没有什么错？好吧，再想想。

当然，专业的程序员应当理解指针的工作方式，但它已经不是现代 C++ 的主旨了。C++ 一直持续不断地发展，昨天正确的代码，到了今天可能就成了糟糕的编程风格。

该语言正在经历大浪淘沙的过程，套用 Bjarne Stroustrup 博士的一句话，“C++ 就像一种新语言，各部分组合较之前更为顺畅。其更高层次的编程风格较之前更为自然，也一如既往的高效。”现在，C++ 有了 Lambda 表达式、内存模型（Memory Model）、Range-based for loops、移动语义（Move Semantics）、可变参数模板（Variadic Template）以及所有其它类似的高级功能，这些都能协助我们完成手上的工作。你是否也有一些旧代码需要按新标准来更新呢？ 不要担心，Clang-tidy 就是你的救星！这个工具非常酷，可以通过静态分析找出老式风格代码，并给出修改建议。在使用 C++ 时，工具的缺乏一直很令人头疼，不过这种情况正在改变。你以为只有 Java 才有自动重构功能？Google 的 Chandler Carruth 在演讲中提到了使用 Ninja 编译 LLVM 和 Clang。它们都能运用自动重构，立即生成1亿行的 C++ 代码。

### 企业代码库的现实场景

很多计算机科学专业的本科生以为自己将会走上像摇滚明星、忍者或者超级英雄那样的事业之路：“只管等着让世界看到我的能力！”这种想法源于他们自认为“是优秀人才，并非常人”。本来抱着一腔期待，准备投身于长时间的设计，以及实现复杂的算法（至少我以前是这么想的），然后获得了第一份工作，结果很快就被20年的老代码给打垮了。有着固定缓存的 strcpy 函数分散在数百个文件、上千行函数、五个版本的手写 linked lists 中——请感受一下。于是你卷起袖子，动手收拾这个烂摊子。结果你的主管对你说道：“不要着急，年轻人，公司老早就要求实现这个功能了。不，我们不准备使用新的 GCC 编译器，别的团队都还没准备好呢。”现在你开始思考：“我哪里犯错了呢……”

这个问题可不是 C++ 所特有的，还会出现在调试一些由 Reflection 爱好者所创建的老旧 Java 代码时。如果你是一名 Web 开发者，很可能会遇到一些 PHP 的问题。即便使用 Ruby、Python 或者一些较新的语言，那些枯燥的工作也都会榨干你的精力。

“你能把那个按钮挪到右边并改成粉色吗？”这就是大多数公司在工作中的现实场景。我想说的是：除了大量遗留问题，或者无聊的代码之外，还存在着少量既有挑战，又有趣的工作，而这些工作有些刚好是 C++ 能发光发热的领域。

### C++ 称霸的领域：游戏、HPC、编译器、金融财务领域等

如果不想把时间全用在增删改查之类的实现上，也许你可以考虑学习 C++ 语言，并选择一个领域。下面我会给出一些建议。

游戏行业：几乎所有3 A 游戏都是使用 C++ 编写的。大众公认电子游戏的开发者是软件行业里回报最高的工作之一，也是需求量最大的领域之一。因为速度非常重要，所以编写高效的代码就是最基本的要求。除了要懂 C++ 之外，精通游戏开发更应注重理论与模式的钻研，而不限于特定的 API 或者 Library。通常还必须具备高超的图形与数学技能，这些知识足够你活到老学到老。

<img src="http://ipad-cms.csdn.net/cms/attachment/201607/577b73260f81d.png" alt="图1  C++持续完善过程（图片来源：https://isocpp.org/std/status）" title="图1  C++持续完善过程（图片来源：https://isocpp.org/std/status）" />

图1  C++ 持续完善过程（图片来源：https://isocpp.org/std/status）

HPC：以极限速度处理数据，要求对底层硬件有深刻的理解，这类知识可以直接应用在语言中。通用图形处理器（GPGPU）及 CUDA、OpenCL 之类的并行计算框架的出现，引发了对有这类技术的C++程序员的需求。如果深入到科学计算领域，还有很多能做的工作。不知你是否听说过机器学习？这是当今的热门话题。

编译器：这是我最喜欢的领域，LLVM 项目如此成功，以致于很难找到一种既未使用 LLVM 库编写前端，也没有使用LLVM生成字节码的流行语言，而这些全都是 C++。尽管编译器是以各种语言编写而成，但其背后的实现原理是相同的。我们使用优化器、静态分析程序、调试程序、标准库、链接器以及所有其他相关的工具来工作。

除此之外，金融领域也有很多工作需要有能力编写低延迟代码的程序员。在这个领域，数学背景也是一大加分亮点。该领域的大多工作可能都涉及到开发与维护高频使用的交易平台。另外如果不想挂着程序员的名头，这个领域也是很棒的选择。可以说负责设计并实现金融数学模型的宽客（Quant）是所有程序员中最有可能获得高额奖励的职位。

以上只是我的几个建议，这些领域的共通点在于：无法通过数量取胜——让一大堆 Java 新手去解决问题，还指望他们得出有效、可维护的解决方案是不可能的。这里面需要很多行业内部的知识门道，只有跟这方面的前辈共过事后才能了解到，也就是说，这些人的可替换性很低。公司必须付给他们更高的薪水，并让他们解决自己感兴趣的问题，才能把人留住。当然，到处都有简单而枯燥的工作，但如果从事的是自己真心喜爱的工作，我们一般也会更有耐性。 

>原文链接：http://itscompiling.eu/2016/03/10/why-learn-cpp-2016/，感谢 Krzysztof 授权《程序员》翻译成中文。 
